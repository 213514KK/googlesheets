<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Jenny Bryan, Joanna Zhao" />

<meta name="date" content="2015-10-10" />

<title>googlesheets Basic Usage</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">googlesheets Basic Usage</h1>
<h4 class="author"><em>Jenny Bryan, Joanna Zhao</em></h4>
<h4 class="date"><em>2015-10-10</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#see-some-spreadsheets-you-can-access">See some spreadsheets you can access</a></li>
<li><a href="#get-a-google-spreadsheet-to-practice-with">Get a Google spreadsheet to practice with</a></li>
<li><a href="#register-a-spreadsheet">Register a spreadsheet</a></li>
<li><a href="#consume-data">Consume data</a></li>
<li><a href="#create-sheets">Create sheets</a></li>
<li><a href="#edit-cells">Edit cells</a></li>
<li><a href="#delete-sheets">Delete sheets</a></li>
<li><a href="#upload-delimited-files-or-excel-workbooks">Upload delimited files or Excel workbooks</a></li>
<li><a href="#download-sheets-as-csv-pdf-or-xlsx-file">Download sheets as csv, pdf, or xlsx file</a></li>
<li><a href="#authorization-using-oauth2">Authorization using OAuth2</a></li>
<li><a href="#old-google-sheets">“Old” Google Sheets</a></li>
</ul>
</div>

<p>First we load the <code>googlesheets</code> package and <code>dplyr</code>, from which we use the <code>%&gt;%</code> pipe operator, among other things. <code>googlesheets</code> usage <em>does not require</em> you to use <code>%&gt;%</code> though it was certainly designed to be pipe-friendly. This vignette uses pipes but you will find that all the examples in the help files use base R only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googlesheets)
<span class="kw">suppressMessages</span>(<span class="kw">library</span>(dplyr))</code></pre></div>
<div id="see-some-spreadsheets-you-can-access" class="section level3">
<h3>See some spreadsheets you can access</h3>
<p>The <code>gs_ls()</code> function returns the sheets you would see in your Google Sheets home screen: <a href="https://docs.google.com/spreadsheets/" class="uri">https://docs.google.com/spreadsheets/</a>. This should include sheets that you own and may also show sheets owned by others but that you are permitted to access, if you have visited the sheet in the browser. Expect a prompt to authenticate yourself in the browser at this point (more below re: auth).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(my_sheets &lt;-<span class="st"> </span><span class="kw">gs_ls</span>())
<span class="co">#&gt; Source: local data frame [51 x 10]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                 sheet_title        author  perm version</span>
<span class="co">#&gt;                       (chr)         (chr) (chr)   (chr)</span>
<span class="co">#&gt; 1  Copy of Twitter Archive…   joannazhaoo     r     new</span>
<span class="co">#&gt; 2      test-gs-iris-private      gspreadr    rw     new</span>
<span class="co">#&gt; 3                  my_sheet      gspreadr    rw     new</span>
<span class="co">#&gt; 4  STAT545 - 2015 - TA Sch…        ksamuk    rw     new</span>
<span class="co">#&gt; 5  Supervisor Interests (R… silwood.mast…     r     new</span>
<span class="co">#&gt; 6               TAGS v6.0ns     m.hawksey     r     new</span>
<span class="co">#&gt; 7               gas_mileage      woo.kara     r     new</span>
<span class="co">#&gt; 8          Flight Risk JSON         chris     r     new</span>
<span class="co">#&gt; 9   EasyTweetSheet - Shared     m.hawksey     r     new</span>
<span class="co">#&gt; 10             #rhizo15 #tw     m.hawksey     r     new</span>
<span class="co">#&gt; ..                      ...           ...   ...     ...</span>
<span class="co">#&gt; Variables not shown: updated (time), sheet_key (chr), ws_feed (chr),</span>
<span class="co">#&gt;   alternate (chr), self (chr), alt_key (chr)</span>
<span class="co"># (expect a prompt to authenticate with Google interactively HERE)</span>
my_sheets %&gt;%<span class="st"> </span><span class="kw">glimpse</span>()
<span class="co">#&gt; Observations: 51</span>
<span class="co">#&gt; Variables: 10</span>
<span class="co">#&gt; $ sheet_title (chr) &quot;Copy of Twitter Archiver v2.1&quot;, &quot;test-gs-iris-pri...</span>
<span class="co">#&gt; $ author      (chr) &quot;joannazhaoo&quot;, &quot;gspreadr&quot;, &quot;gspreadr&quot;, &quot;ksamuk&quot;, &quot;...</span>
<span class="co">#&gt; $ perm        (chr) &quot;r&quot;, &quot;rw&quot;, &quot;rw&quot;, &quot;rw&quot;, &quot;r&quot;, &quot;r&quot;, &quot;r&quot;, &quot;r&quot;, &quot;r&quot;, &quot;r...</span>
<span class="co">#&gt; $ version     (chr) &quot;new&quot;, &quot;new&quot;, &quot;new&quot;, &quot;new&quot;, &quot;new&quot;, &quot;new&quot;, &quot;new&quot;, &quot;...</span>
<span class="co">#&gt; $ updated     (time) 2015-10-10 21:56:25, 2015-10-09 00:25:47, 2015-10...</span>
<span class="co">#&gt; $ sheet_key   (chr) &quot;1DoMXh2m3FGPoZAle9vnzg763D9FESTU506iqWkUTwtE&quot;, &quot;1...</span>
<span class="co">#&gt; $ ws_feed     (chr) &quot;https://spreadsheets.google.com/feeds/worksheets/...</span>
<span class="co">#&gt; $ alternate   (chr) &quot;https://docs.google.com/spreadsheets/d/1DoMXh2m3F...</span>
<span class="co">#&gt; $ self        (chr) &quot;https://spreadsheets.google.com/feeds/spreadsheet...</span>
<span class="co">#&gt; $ alt_key     (chr) NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...</span></code></pre></div>
</div>
<div id="get-a-google-spreadsheet-to-practice-with" class="section level3">
<h3>Get a Google spreadsheet to practice with</h3>
<p>Don’t worry if you don’t have any suitable Google Sheets lying around! We’ve published a sheet for you to practice with and have built functions into <code>googlesheets</code> to help you access it. The example sheet holds some of the <a href="https://github.com/jennybc/gapminder">Gapminder data</a>; feel free to <a href="https://w3id.org/people/jennybc/googlesheets_gap_url">visit the Sheet in the browser</a>. The code below will put a copy of this sheet into your Drive, titled “Gapminder”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gs_gap</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gs_copy</span>(<span class="dt">to =</span> <span class="st">&quot;Gapminder&quot;</span>)</code></pre></div>
<p>If that seems to have worked, go check for a sheet named “Gapminder” in your Google Sheets home screen: <a href="https://docs.google.com/spreadsheets/" class="uri">https://docs.google.com/spreadsheets/</a>. You could also run <code>gs_ls()</code> again and make sure the Gapminder sheet is listed.</p>
</div>
<div id="register-a-spreadsheet" class="section level3">
<h3>Register a spreadsheet</h3>
<p>If you plan to consume data from a sheet or edit it, you must first <strong>register</strong> it. This is how <code>googlesheets</code> records important info about the sheet that is required downstream by the Google Sheets or Google Drive APIs. Once registered, you can print the result to get some basic info about the sheet.</p>
<p><code>googlesheets</code> provides several registration functions. Specifying the sheet by title? Use <code>gs_title()</code>. By key? Use <code>gs_key()</code>. You get the idea.</p>
<p><em>We’re using the built-in functions <code>gs_gap_key()</code> and <code>gs_gap_url()</code> to produce the key and browser URL for the Gapminder example sheet, so you can see how this will play out with your own projects.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap &lt;-<span class="st"> </span><span class="kw">gs_title</span>(<span class="st">&quot;Gapminder&quot;</span>)
<span class="co">#&gt; Sheet successfully identifed: &quot;Gapminder&quot;</span>
gap
<span class="co">#&gt;                   Spreadsheet title: Gapminder</span>
<span class="co">#&gt;                  Spreadsheet author: gspreadr</span>
<span class="co">#&gt;   Date of googlesheets registration: 2015-10-10 21:57:58 GMT</span>
<span class="co">#&gt;     Date of last spreadsheet update: 2015-03-23 20:34:08 GMT</span>
<span class="co">#&gt;                          visibility: private</span>
<span class="co">#&gt;                         permissions: rw</span>
<span class="co">#&gt;                             version: new</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Contains 5 worksheets:</span>
<span class="co">#&gt; (Title): (Nominal worksheet extent as rows x columns)</span>
<span class="co">#&gt; Africa: 625 x 6</span>
<span class="co">#&gt; Americas: 301 x 6</span>
<span class="co">#&gt; Asia: 397 x 6</span>
<span class="co">#&gt; Europe: 361 x 6</span>
<span class="co">#&gt; Oceania: 25 x 6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Key: 1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA</span>
<span class="co">#&gt; Browser URL: https://docs.google.com/spreadsheets/d/1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA/</span>

<span class="co"># Need to access a sheet you do not own?</span>
<span class="co"># Access it by key if you know it!</span>
(GAP_KEY &lt;-<span class="st"> </span><span class="kw">gs_gap_key</span>())
<span class="co">#&gt; [1] &quot;1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ&quot;</span>
third_party_gap &lt;-<span class="st"> </span>GAP_KEY %&gt;%
<span class="st">  </span><span class="kw">gs_key</span>()
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;test-gs-gapminder&quot;</span>

<span class="co"># Need to access a sheet you do not own but you have a sharing link?</span>
<span class="co"># Access it by URL!</span>
(GAP_URL &lt;-<span class="st"> </span><span class="kw">gs_gap_url</span>())
<span class="co">#&gt; [1] &quot;https://docs.google.com/spreadsheets/d/1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ/&quot;</span>
third_party_gap &lt;-<span class="st"> </span>GAP_URL %&gt;%
<span class="st">  </span><span class="kw">gs_url</span>()
<span class="co">#&gt; Sheet-identifying info appears to be a browser URL.</span>
<span class="co">#&gt; googlesheets will attempt to extract sheet key from the URL.</span>
<span class="co">#&gt; Putative key: 1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ</span>
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;test-gs-gapminder&quot;</span>
<span class="co"># note: registration via URL may not work for &quot;old&quot; sheets</span>

<span class="co"># Worried that a spreadsheet's registration is out-of-date?</span>
<span class="co"># Re-register it!</span>
gap &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_gs</span>()
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;Gapminder&quot;</span></code></pre></div>
<p>The registration functions <code>gs_title()</code>, <code>gs_key()</code>, <code>gs_url()</code>, and <code>gs_gs()</code> return a registered sheet as a <code>googlesheet</code> object, which is the first argument to practically every function in this package. Likewise, almost every function returns a freshly registered <code>googlesheet</code> object, ready to be stored or piped into the next command.</p>
<p><em>We export a utility function, <code>extract_key_from_url()</code>, to help you get and store the key from a browser URL. Registering via browser URL is fine, but registering by key is probably a better idea in the long-run.</em></p>
</div>
<div id="consume-data" class="section level3">
<h3>Consume data</h3>
<div id="ignorance-is-bliss" class="section level4">
<h4>Ignorance is bliss</h4>
<p>If you want to consume the data in a worksheet and get something rectangular back, use the all-purpose function <code>gs_read()</code>. By default, it reads all the data in a worksheet.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oceania &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Oceania&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
oceania
<span class="co">#&gt; Source: local data frame [24 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      country continent  year lifeExp      pop gdpPercap</span>
<span class="co">#&gt;        (chr)     (chr) (int)   (dbl)    (int)     (dbl)</span>
<span class="co">#&gt; 1  Australia   Oceania  1952   69.12  8691212  10039.60</span>
<span class="co">#&gt; 2  Australia   Oceania  1957   70.33  9712569  10949.65</span>
<span class="co">#&gt; 3  Australia   Oceania  1962   70.93 10794968  12217.23</span>
<span class="co">#&gt; 4  Australia   Oceania  1967   71.10 11872264  14526.12</span>
<span class="co">#&gt; 5  Australia   Oceania  1972   71.93 13177000  16788.63</span>
<span class="co">#&gt; 6  Australia   Oceania  1977   73.49 14074100  18334.20</span>
<span class="co">#&gt; 7  Australia   Oceania  1982   74.74 15184200  19477.01</span>
<span class="co">#&gt; 8  Australia   Oceania  1987   76.32 16257249  21888.89</span>
<span class="co">#&gt; 9  Australia   Oceania  1992   77.56 17481977  23424.77</span>
<span class="co">#&gt; 10 Australia   Oceania  1997   78.83 18565243  26997.94</span>
<span class="co">#&gt; ..       ...       ...   ...     ...      ...       ...</span>
<span class="kw">str</span>(oceania)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    24 obs. of  6 variables:</span>
<span class="co">#&gt;  $ country  : chr  &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...</span>
<span class="co">#&gt;  $ continent: chr  &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; ...</span>
<span class="co">#&gt;  $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span>
<span class="co">#&gt;  $ lifeExp  : num  69.1 70.3 70.9 71.1 71.9 ...</span>
<span class="co">#&gt;  $ pop      : int  8691212 9712569 10794968 11872264 13177000 14074100 15184200 16257249 17481977 18565243 ...</span>
<span class="co">#&gt;  $ gdpPercap: num  10040 10950 12217 14526 16789 ...</span>
<span class="kw">glimpse</span>(oceania)
<span class="co">#&gt; Observations: 24</span>
<span class="co">#&gt; Variables: 6</span>
<span class="co">#&gt; $ country   (chr) &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, &quot;Australia&quot;, ...</span>
<span class="co">#&gt; $ continent (chr) &quot;Oceania&quot;, &quot;Oceania&quot;, &quot;Oceania&quot;, &quot;Oceania&quot;, &quot;Oceania...</span>
<span class="co">#&gt; $ year      (int) 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992...</span>
<span class="co">#&gt; $ lifeExp   (dbl) 69.120, 70.330, 70.930, 71.100, 71.930, 73.490, 74.7...</span>
<span class="co">#&gt; $ pop       (int) 8691212, 9712569, 10794968, 11872264, 13177000, 1407...</span>
<span class="co">#&gt; $ gdpPercap (dbl) 10039.60, 10949.65, 12217.23, 14526.12, 16788.63, 18...</span></code></pre></div>
<p>You can target specific cells via the <code>range =</code> argument. The simplest usage is to specify an Excel-like cell range, such as range = “D12:F15” or range = “R1C12:R6C15”. The cell rectangle can be specified in various other ways, using helper functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="dv">2</span>, <span class="dt">range =</span> <span class="st">&quot;A1:D8&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Americas&quot;</span>
<span class="co">#&gt; Source: local data frame [7 x 4]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     country continent  year lifeExp</span>
<span class="co">#&gt;       (chr)     (chr) (int)   (dbl)</span>
<span class="co">#&gt; 1 Argentina  Americas  1952  62.485</span>
<span class="co">#&gt; 2 Argentina  Americas  1957  64.399</span>
<span class="co">#&gt; 3 Argentina  Americas  1962  65.142</span>
<span class="co">#&gt; 4 Argentina  Americas  1967  65.634</span>
<span class="co">#&gt; 5 Argentina  Americas  1972  67.065</span>
<span class="co">#&gt; 6 Argentina  Americas  1977  68.481</span>
<span class="co">#&gt; 7 Argentina  Americas  1982  69.942</span>
gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Europe&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">1</span>:<span class="dv">4</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Europe&quot;</span>
<span class="co">#&gt; Source: local data frame [3 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   country continent  year lifeExp     pop gdpPercap</span>
<span class="co">#&gt;     (chr)     (chr) (int)   (dbl)   (int)     (dbl)</span>
<span class="co">#&gt; 1 Albania    Europe  1952   55.23 1282697  1601.056</span>
<span class="co">#&gt; 2 Albania    Europe  1957   59.28 1476505  1942.284</span>
<span class="co">#&gt; 3 Albania    Europe  1962   64.82 1728137  2312.889</span>
gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Europe&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">100</span>:<span class="dv">103</span>), <span class="dt">col_names =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Europe&quot;</span>
<span class="co">#&gt; Source: local data frame [4 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        X1     X2    X3    X4      X5        X6</span>
<span class="co">#&gt;     (chr)  (chr) (int) (dbl)   (int)     (dbl)</span>
<span class="co">#&gt; 1 Finland Europe  1962 68.75 4491443  9371.843</span>
<span class="co">#&gt; 2 Finland Europe  1967 69.83 4605744 10921.636</span>
<span class="co">#&gt; 3 Finland Europe  1972 70.87 4639657 14358.876</span>
<span class="co">#&gt; 4 Finland Europe  1977 72.52 4738902 15605.423</span>
gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Africa&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="dv">1</span>:<span class="dv">4</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Africa&quot;</span>
<span class="co">#&gt; Source: local data frame [624 x 4]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    country continent  year lifeExp</span>
<span class="co">#&gt;      (chr)     (chr) (int)   (dbl)</span>
<span class="co">#&gt; 1  Algeria    Africa  1952  43.077</span>
<span class="co">#&gt; 2  Algeria    Africa  1957  45.685</span>
<span class="co">#&gt; 3  Algeria    Africa  1962  48.303</span>
<span class="co">#&gt; 4  Algeria    Africa  1967  51.407</span>
<span class="co">#&gt; 5  Algeria    Africa  1972  54.518</span>
<span class="co">#&gt; 6  Algeria    Africa  1977  58.014</span>
<span class="co">#&gt; 7  Algeria    Africa  1982  61.368</span>
<span class="co">#&gt; 8  Algeria    Africa  1987  65.799</span>
<span class="co">#&gt; 9  Algeria    Africa  1992  67.744</span>
<span class="co">#&gt; 10 Algeria    Africa  1997  69.152</span>
<span class="co">#&gt; ..     ...       ...   ...     ...</span>
gap %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Asia&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_limits</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">5</span>, <span class="ot">NA</span>)))
<span class="co">#&gt; Accessing worksheet titled &quot;Asia&quot;</span>
<span class="co">#&gt; Source: local data frame [4 x 3]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   lifeExp      pop gdpPercap</span>
<span class="co">#&gt;     (dbl)    (dbl)     (dbl)</span>
<span class="co">#&gt; 1  28.801  8425333  779.4453</span>
<span class="co">#&gt; 2  30.332  9240934  820.8530</span>
<span class="co">#&gt; 3  31.997 10267083  853.1007</span>
<span class="co">#&gt; 4  34.020 11537966  836.1971</span></code></pre></div>
<p><code>gs_read()</code> is a wrapper that bundles together the most common methods to read data from the API and transform it for downstream use. You can refine it’s behavior further, by passing more arguments via <code>...</code>. Read the help file for more details.</p>
<p>If <code>gs_read()</code> doesn’t do what you need, then keep reading for the underlying functions to read and post-process data.</p>
</div>
<div id="specify-the-consumption-method" class="section level4">
<h4>Specify the consumption method</h4>
<p>There are three ways to consume data from a worksheet within a Google spreadsheet. The order goes from fastest-but-more-limited to slowest-but-most-flexible:</p>
<ul>
<li><code>gs_read_csv()</code>: Don’t let the name scare you! Nothing is written to file during this process. The name just reflects that, under the hood, we request the data via the “exportcsv” link. For cases where <code>gs_read_csv()</code> and <code>gs_read_listfeed()</code> both work, we see that <code>gs_read_csv()</code> is around <strong>50 times faster</strong>. Use this when your data occupies a nice rectangle in the sheet and you’re willing to consume all of it. You will get a <code>tbl_df</code> back, which is basically just a <code>data.frame</code>. In fact, you might want to use <code>gs_read_csv()</code> in other, less tidy scenarios and do further munging in R.</li>
<li><code>gs_read_listfeed()</code>: Gets data via the <a href="https://developers.google.com/google-apps/spreadsheets/#working_with_list-based_feeds">“list feed”</a>, which consumes data row-by-row. Like <code>gs_read_csv()</code>, this is appropriate when your data occupies a nice rectangle. You will again get a <code>tbl_df</code> back, but your variable names may have been mangled (by Google, not us!). Specifically, variable names will be forcefully lowercased and all non-alpha-numeric characters will be removed. Why do we even have this function? The list feed supports some query parameters for sorting and filtering the data, which we plan to support (#17).</li>
<li><code>gs_read_cellfeed()</code>: Get data via the <a href="https://developers.google.com/google-apps/spreadsheets/#working_with_cell-based_feeds">“cell feed”</a>, which consumes data cell-by-cell. This is appropriate when you want to consume arbitrary cells, rows, columns, and regions of the sheet. It is invoked by <code>gs_read()</code> whenever the <code>range =</code> argument is used. It works great for modest amounts of data but can be rather slow otherwise. <code>gs_read_cellfeed()</code> returns a <code>tbl_df</code> with <strong>one row per cell</strong>. You can target specific cells via the <code>range</code> argument. See below for demos of <code>gs_reshape_cellfeed()</code> and <code>gs_simplify_cellfeed()</code> which help with post-processing.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the data for worksheet &quot;Oceania&quot;: the super-fast csv way</span>
oceania_csv &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_csv</span>(<span class="dt">ws =</span> <span class="st">&quot;Oceania&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="kw">str</span>(oceania_csv)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    24 obs. of  6 variables:</span>
<span class="co">#&gt;  $ country  : chr  &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...</span>
<span class="co">#&gt;  $ continent: chr  &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; ...</span>
<span class="co">#&gt;  $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span>
<span class="co">#&gt;  $ lifeExp  : num  69.1 70.3 70.9 71.1 71.9 ...</span>
<span class="co">#&gt;  $ pop      : int  8691212 9712569 10794968 11872264 13177000 14074100 15184200 16257249 17481977 18565243 ...</span>
<span class="co">#&gt;  $ gdpPercap: num  10040 10950 12217 14526 16789 ...</span>
oceania_csv
<span class="co">#&gt; Source: local data frame [24 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      country continent  year lifeExp      pop gdpPercap</span>
<span class="co">#&gt;        (chr)     (chr) (int)   (dbl)    (int)     (dbl)</span>
<span class="co">#&gt; 1  Australia   Oceania  1952   69.12  8691212  10039.60</span>
<span class="co">#&gt; 2  Australia   Oceania  1957   70.33  9712569  10949.65</span>
<span class="co">#&gt; 3  Australia   Oceania  1962   70.93 10794968  12217.23</span>
<span class="co">#&gt; 4  Australia   Oceania  1967   71.10 11872264  14526.12</span>
<span class="co">#&gt; 5  Australia   Oceania  1972   71.93 13177000  16788.63</span>
<span class="co">#&gt; 6  Australia   Oceania  1977   73.49 14074100  18334.20</span>
<span class="co">#&gt; 7  Australia   Oceania  1982   74.74 15184200  19477.01</span>
<span class="co">#&gt; 8  Australia   Oceania  1987   76.32 16257249  21888.89</span>
<span class="co">#&gt; 9  Australia   Oceania  1992   77.56 17481977  23424.77</span>
<span class="co">#&gt; 10 Australia   Oceania  1997   78.83 18565243  26997.94</span>
<span class="co">#&gt; ..       ...       ...   ...     ...      ...       ...</span>

<span class="co"># Get the data for worksheet &quot;Oceania&quot;: the less-fast tabular way (&quot;list feed&quot;)</span>
oceania_list_feed &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_listfeed</span>(<span class="dt">ws =</span> <span class="st">&quot;Oceania&quot;</span>) 
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="kw">str</span>(oceania_list_feed)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    24 obs. of  6 variables:</span>
<span class="co">#&gt;  $ country  : chr  &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...</span>
<span class="co">#&gt;  $ continent: chr  &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; ...</span>
<span class="co">#&gt;  $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span>
<span class="co">#&gt;  $ lifeexp  : num  69.1 70.3 70.9 71.1 71.9 ...</span>
<span class="co">#&gt;  $ pop      : int  8691212 9712569 10794968 11872264 13177000 14074100 15184200 16257249 17481977 18565243 ...</span>
<span class="co">#&gt;  $ gdppercap: num  10040 10950 12217 14526 16789 ...</span>
oceania_list_feed
<span class="co">#&gt; Source: local data frame [24 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      country continent  year lifeexp      pop gdppercap</span>
<span class="co">#&gt;        (chr)     (chr) (int)   (dbl)    (int)     (dbl)</span>
<span class="co">#&gt; 1  Australia   Oceania  1952   69.12  8691212  10039.60</span>
<span class="co">#&gt; 2  Australia   Oceania  1957   70.33  9712569  10949.65</span>
<span class="co">#&gt; 3  Australia   Oceania  1962   70.93 10794968  12217.23</span>
<span class="co">#&gt; 4  Australia   Oceania  1967   71.10 11872264  14526.12</span>
<span class="co">#&gt; 5  Australia   Oceania  1972   71.93 13177000  16788.63</span>
<span class="co">#&gt; 6  Australia   Oceania  1977   73.49 14074100  18334.20</span>
<span class="co">#&gt; 7  Australia   Oceania  1982   74.74 15184200  19477.01</span>
<span class="co">#&gt; 8  Australia   Oceania  1987   76.32 16257249  21888.89</span>
<span class="co">#&gt; 9  Australia   Oceania  1992   77.56 17481977  23424.77</span>
<span class="co">#&gt; 10 Australia   Oceania  1997   78.83 18565243  26997.94</span>
<span class="co">#&gt; ..       ...       ...   ...     ...      ...       ...</span>

<span class="co"># Get the data for worksheet &quot;Oceania&quot;: the slow cell-by-cell way (&quot;cell feed&quot;)</span>
oceania_cell_feed &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_cellfeed</span>(<span class="dt">ws =</span> <span class="st">&quot;Oceania&quot;</span>) 
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="kw">str</span>(oceania_cell_feed)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    150 obs. of  5 variables:</span>
<span class="co">#&gt;  $ cell     : chr  &quot;A1&quot; &quot;B1&quot; &quot;C1&quot; &quot;D1&quot; ...</span>
<span class="co">#&gt;  $ cell_alt : chr  &quot;R1C1&quot; &quot;R1C2&quot; &quot;R1C3&quot; &quot;R1C4&quot; ...</span>
<span class="co">#&gt;  $ row      : int  1 1 1 1 1 1 2 2 2 2 ...</span>
<span class="co">#&gt;  $ col      : int  1 2 3 4 5 6 1 2 3 4 ...</span>
<span class="co">#&gt;  $ cell_text: chr  &quot;country&quot; &quot;continent&quot; &quot;year&quot; &quot;lifeExp&quot; ...</span>
<span class="co">#&gt;  - attr(*, &quot;ws_title&quot;)= chr &quot;Oceania&quot;</span>
oceania_cell_feed
<span class="co">#&gt; Source: local data frame [150 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cell cell_alt   row   col cell_text</span>
<span class="co">#&gt;    (chr)    (chr) (int) (int)     (chr)</span>
<span class="co">#&gt; 1     A1     R1C1     1     1   country</span>
<span class="co">#&gt; 2     B1     R1C2     1     2 continent</span>
<span class="co">#&gt; 3     C1     R1C3     1     3      year</span>
<span class="co">#&gt; 4     D1     R1C4     1     4   lifeExp</span>
<span class="co">#&gt; 5     E1     R1C5     1     5       pop</span>
<span class="co">#&gt; 6     F1     R1C6     1     6 gdpPercap</span>
<span class="co">#&gt; 7     A2     R2C1     2     1 Australia</span>
<span class="co">#&gt; 8     B2     R2C2     2     2   Oceania</span>
<span class="co">#&gt; 9     C2     R2C3     2     3      1952</span>
<span class="co">#&gt; 10    D2     R2C4     2     4     69.12</span>
<span class="co">#&gt; ..   ...      ...   ...   ...       ...</span></code></pre></div>
</div>
<div id="quick-speed-comparison" class="section level4">
<h4>Quick speed comparison</h4>
<p>Let’s consume all the data for Africa by all 3 methods and see how long it takes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">jfun &lt;-<span class="st"> </span>function(readfun)
  <span class="kw">system.time</span>(<span class="kw">do.call</span>(readfun, <span class="kw">list</span>(<span class="kw">gs_gap</span>(), <span class="dt">ws =</span> <span class="st">&quot;Africa&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)))
readfuns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gs_read_csv&quot;</span>, <span class="st">&quot;gs_read_listfeed&quot;</span>, <span class="st">&quot;gs_read_cellfeed&quot;</span>)
readfuns &lt;-<span class="st"> </span><span class="kw">sapply</span>(readfuns, get, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>)
<span class="kw">sapply</span>(readfuns, jfun)
<span class="co">#&gt;            gs_read_csv gs_read_listfeed gs_read_cellfeed</span>
<span class="co">#&gt; user.self        0.038            0.158            1.047</span>
<span class="co">#&gt; sys.self         0.001            0.016            0.037</span>
<span class="co">#&gt; elapsed          0.481            0.940            2.588</span>
<span class="co">#&gt; user.child       0.000            0.000            0.000</span>
<span class="co">#&gt; sys.child        0.000            0.000            0.000</span></code></pre></div>
</div>
<div id="post-processing-data-from-the-cell-feed" class="section level4">
<h4>Post-processing data from the cell feed</h4>
<p>If you consume data from the cell feed with <code>gs_read_cellfeed(..., range = ...)</code>, you get a data.frame back with <strong>one row per cell</strong>. The package offers two functions to post-process this into something more useful, <code>gs_reshape_cellfeed()</code> and <code>gs_simplify_cellfeed()</code>.</p>
<p>To reshape into a table, use <code>gs_reshape_cellfeed()</code>. You can signal that the first row contains column names (or not) with <code>col_names = TRUE</code> (or <code>FALSE</code>). Or you can provide a character vector of names. This is inspired by the <code>col_names</code> argument of <code>readxl::read_excel()</code> and <code>readr::read_delim()</code>, which generalizes the <code>header</code> argument of <code>read.table()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reshape: instead of one row per cell, make a nice rectangular data.frame</span>
australia_cell_feed &lt;-<span class="st"> </span>gap %&gt;%
<span class="st">  </span><span class="kw">gs_read_cellfeed</span>(<span class="dt">ws =</span> <span class="st">&quot;Oceania&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;A1:F13&quot;</span>) 
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="kw">str</span>(australia_cell_feed)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    78 obs. of  5 variables:</span>
<span class="co">#&gt;  $ cell     : chr  &quot;A1&quot; &quot;B1&quot; &quot;C1&quot; &quot;D1&quot; ...</span>
<span class="co">#&gt;  $ cell_alt : chr  &quot;R1C1&quot; &quot;R1C2&quot; &quot;R1C3&quot; &quot;R1C4&quot; ...</span>
<span class="co">#&gt;  $ row      : int  1 1 1 1 1 1 2 2 2 2 ...</span>
<span class="co">#&gt;  $ col      : int  1 2 3 4 5 6 1 2 3 4 ...</span>
<span class="co">#&gt;  $ cell_text: chr  &quot;country&quot; &quot;continent&quot; &quot;year&quot; &quot;lifeExp&quot; ...</span>
<span class="co">#&gt;  - attr(*, &quot;ws_title&quot;)= chr &quot;Oceania&quot;</span>
oceania_cell_feed
<span class="co">#&gt; Source: local data frame [150 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cell cell_alt   row   col cell_text</span>
<span class="co">#&gt;    (chr)    (chr) (int) (int)     (chr)</span>
<span class="co">#&gt; 1     A1     R1C1     1     1   country</span>
<span class="co">#&gt; 2     B1     R1C2     1     2 continent</span>
<span class="co">#&gt; 3     C1     R1C3     1     3      year</span>
<span class="co">#&gt; 4     D1     R1C4     1     4   lifeExp</span>
<span class="co">#&gt; 5     E1     R1C5     1     5       pop</span>
<span class="co">#&gt; 6     F1     R1C6     1     6 gdpPercap</span>
<span class="co">#&gt; 7     A2     R2C1     2     1 Australia</span>
<span class="co">#&gt; 8     B2     R2C2     2     2   Oceania</span>
<span class="co">#&gt; 9     C2     R2C3     2     3      1952</span>
<span class="co">#&gt; 10    D2     R2C4     2     4     69.12</span>
<span class="co">#&gt; ..   ...      ...   ...   ...       ...</span>
australia_reshaped &lt;-<span class="st"> </span>australia_cell_feed %&gt;%<span class="st"> </span><span class="kw">gs_reshape_cellfeed</span>()
<span class="kw">str</span>(australia_reshaped)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    12 obs. of  6 variables:</span>
<span class="co">#&gt;  $ country  : chr  &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; &quot;Australia&quot; ...</span>
<span class="co">#&gt;  $ continent: chr  &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; &quot;Oceania&quot; ...</span>
<span class="co">#&gt;  $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span>
<span class="co">#&gt;  $ lifeExp  : num  69.1 70.3 70.9 71.1 71.9 ...</span>
<span class="co">#&gt;  $ pop      : int  8691212 9712569 10794968 11872264 13177000 14074100 15184200 16257249 17481977 18565243 ...</span>
<span class="co">#&gt;  $ gdpPercap: num  10040 10950 12217 14526 16789 ...</span>
australia_reshaped
<span class="co">#&gt; Source: local data frame [12 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      country continent  year lifeExp      pop gdpPercap</span>
<span class="co">#&gt;        (chr)     (chr) (int)   (dbl)    (int)     (dbl)</span>
<span class="co">#&gt; 1  Australia   Oceania  1952  69.120  8691212  10039.60</span>
<span class="co">#&gt; 2  Australia   Oceania  1957  70.330  9712569  10949.65</span>
<span class="co">#&gt; 3  Australia   Oceania  1962  70.930 10794968  12217.23</span>
<span class="co">#&gt; 4  Australia   Oceania  1967  71.100 11872264  14526.12</span>
<span class="co">#&gt; 5  Australia   Oceania  1972  71.930 13177000  16788.63</span>
<span class="co">#&gt; 6  Australia   Oceania  1977  73.490 14074100  18334.20</span>
<span class="co">#&gt; 7  Australia   Oceania  1982  74.740 15184200  19477.01</span>
<span class="co">#&gt; 8  Australia   Oceania  1987  76.320 16257249  21888.89</span>
<span class="co">#&gt; 9  Australia   Oceania  1992  77.560 17481977  23424.77</span>
<span class="co">#&gt; 10 Australia   Oceania  1997  78.830 18565243  26997.94</span>
<span class="co">#&gt; 11 Australia   Oceania  2002  80.370 19546792  30687.75</span>
<span class="co">#&gt; 12 Australia   Oceania  2007  81.235 20434176  34435.37</span>

<span class="co"># Example: first 3 rows</span>
gap_3rows &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_cellfeed</span>(<span class="st">&quot;Europe&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">1</span>:<span class="dv">3</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Europe&quot;</span>
gap_3rows %&gt;%<span class="st"> </span><span class="kw">head</span>()
<span class="co">#&gt; Source: local data frame [6 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    cell cell_alt   row   col cell_text</span>
<span class="co">#&gt;   (chr)    (chr) (int) (int)     (chr)</span>
<span class="co">#&gt; 1    A1     R1C1     1     1   country</span>
<span class="co">#&gt; 2    B1     R1C2     1     2 continent</span>
<span class="co">#&gt; 3    C1     R1C3     1     3      year</span>
<span class="co">#&gt; 4    D1     R1C4     1     4   lifeExp</span>
<span class="co">#&gt; 5    E1     R1C5     1     5       pop</span>
<span class="co">#&gt; 6    F1     R1C6     1     6 gdpPercap</span>

<span class="co"># convert to a data.frame (by default, column names found in first row)</span>
gap_3rows %&gt;%<span class="st"> </span><span class="kw">gs_reshape_cellfeed</span>()
<span class="co">#&gt; Source: local data frame [2 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   country continent  year lifeExp     pop gdpPercap</span>
<span class="co">#&gt;     (chr)     (chr) (int)   (dbl)   (int)     (dbl)</span>
<span class="co">#&gt; 1 Albania    Europe  1952   55.23 1282697  1601.056</span>
<span class="co">#&gt; 2 Albania    Europe  1957   59.28 1476505  1942.284</span>

<span class="co"># arbitrary cell range, column names no longer available in first row</span>
gap %&gt;%
<span class="st">  </span><span class="kw">gs_read_cellfeed</span>(<span class="st">&quot;Oceania&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;D12:F15&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">gs_reshape_cellfeed</span>(<span class="dt">col_names =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="co">#&gt; Source: local data frame [4 x 3]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       X4       X5       X6</span>
<span class="co">#&gt;    (dbl)    (dbl)    (dbl)</span>
<span class="co">#&gt; 1 80.370 19546792 30687.75</span>
<span class="co">#&gt; 2 81.235 20434176 34435.37</span>
<span class="co">#&gt; 3 69.390  1994794 10556.58</span>
<span class="co">#&gt; 4 70.260  2229407 12247.40</span>

<span class="co"># arbitrary cell range, direct specification of column names</span>
gap %&gt;%
<span class="st">  </span><span class="kw">gs_read_cellfeed</span>(<span class="st">&quot;Oceania&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_limits</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>))) %&gt;%
<span class="st">  </span><span class="kw">gs_reshape_cellfeed</span>(<span class="dt">col_names =</span> <span class="kw">paste</span>(<span class="st">&quot;thing&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>),
                                        <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Oceania&quot;</span>
<span class="co">#&gt; Source: local data frame [4 x 3]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   thing_one thing_two thing_three</span>
<span class="co">#&gt;       (chr)     (chr)       (int)</span>
<span class="co">#&gt; 1 Australia   Oceania        1952</span>
<span class="co">#&gt; 2 Australia   Oceania        1957</span>
<span class="co">#&gt; 3 Australia   Oceania        1962</span>
<span class="co">#&gt; 4 Australia   Oceania        1967</span></code></pre></div>
<p>To extract the cell data into an atomic vector, possibly named, use <code>gs_simplify_cellfeed()</code>. You can signal that the first row contains column names (or not) with <code>col_names = TRUE</code> (or <code>FALSE</code>). There are several arguments to control conversion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example: first row only</span>
gap_1row &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_cellfeed</span>(<span class="st">&quot;Europe&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">1</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Europe&quot;</span>
gap_1row
<span class="co">#&gt; Source: local data frame [6 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    cell cell_alt   row   col cell_text</span>
<span class="co">#&gt;   (chr)    (chr) (int) (int)     (chr)</span>
<span class="co">#&gt; 1    A1     R1C1     1     1   country</span>
<span class="co">#&gt; 2    B1     R1C2     1     2 continent</span>
<span class="co">#&gt; 3    C1     R1C3     1     3      year</span>
<span class="co">#&gt; 4    D1     R1C4     1     4   lifeExp</span>
<span class="co">#&gt; 5    E1     R1C5     1     5       pop</span>
<span class="co">#&gt; 6    F1     R1C6     1     6 gdpPercap</span>

<span class="co"># convert to a named (character) vector</span>
gap_1row %&gt;%<span class="st"> </span><span class="kw">gs_simplify_cellfeed</span>()
<span class="co">#&gt;          A1          B1          C1          D1          E1          F1 </span>
<span class="co">#&gt;   &quot;country&quot; &quot;continent&quot;      &quot;year&quot;   &quot;lifeExp&quot;       &quot;pop&quot; &quot;gdpPercap&quot;</span>

<span class="co"># Example: single column</span>
gap_1col &lt;-<span class="st"> </span>gap %&gt;%<span class="st"> </span><span class="kw">gs_read_cellfeed</span>(<span class="st">&quot;Europe&quot;</span>, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="dv">3</span>))
<span class="co">#&gt; Accessing worksheet titled &quot;Europe&quot;</span>
gap_1col
<span class="co">#&gt; Source: local data frame [361 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cell cell_alt   row   col cell_text</span>
<span class="co">#&gt;    (chr)    (chr) (int) (int)     (chr)</span>
<span class="co">#&gt; 1     C1     R1C3     1     3      year</span>
<span class="co">#&gt; 2     C2     R2C3     2     3      1952</span>
<span class="co">#&gt; 3     C3     R3C3     3     3      1957</span>
<span class="co">#&gt; 4     C4     R4C3     4     3      1962</span>
<span class="co">#&gt; 5     C5     R5C3     5     3      1967</span>
<span class="co">#&gt; 6     C6     R6C3     6     3      1972</span>
<span class="co">#&gt; 7     C7     R7C3     7     3      1977</span>
<span class="co">#&gt; 8     C8     R8C3     8     3      1982</span>
<span class="co">#&gt; 9     C9     R9C3     9     3      1987</span>
<span class="co">#&gt; 10   C10    R10C3    10     3      1992</span>
<span class="co">#&gt; ..   ...      ...   ...   ...       ...</span>

<span class="co"># drop the variable name and convert to an un-named (integer) vector</span>
gap_1col %&gt;%<span class="st"> </span><span class="kw">gs_simplify_cellfeed</span>(<span class="dt">notation =</span> <span class="st">&quot;none&quot;</span>)
<span class="co">#&gt;   [1] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957</span>
<span class="co">#&gt;  [15] 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967</span>
<span class="co">#&gt;  [29] 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977</span>
<span class="co">#&gt;  [43] 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987</span>
<span class="co">#&gt;  [57] 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997</span>
<span class="co">#&gt;  [71] 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</span>
<span class="co">#&gt;  [85] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957</span>
<span class="co">#&gt;  [99] 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967</span>
<span class="co">#&gt; [113] 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977</span>
<span class="co">#&gt; [127] 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987</span>
<span class="co">#&gt; [141] 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997</span>
<span class="co">#&gt; [155] 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</span>
<span class="co">#&gt; [169] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957</span>
<span class="co">#&gt; [183] 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967</span>
<span class="co">#&gt; [197] 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977</span>
<span class="co">#&gt; [211] 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987</span>
<span class="co">#&gt; [225] 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997</span>
<span class="co">#&gt; [239] 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</span>
<span class="co">#&gt; [253] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957</span>
<span class="co">#&gt; [267] 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967</span>
<span class="co">#&gt; [281] 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977</span>
<span class="co">#&gt; [295] 1982 1987 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987</span>
<span class="co">#&gt; [309] 1992 1997 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997</span>
<span class="co">#&gt; [323] 2002 2007 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</span>
<span class="co">#&gt; [337] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 1952 1957</span>
<span class="co">#&gt; [351] 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007</span></code></pre></div>
</div>
</div>
<div id="create-sheets" class="section level3">
<h3>Create sheets</h3>
<p>You can use <code>googlesheets</code> to create new spreadsheets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo &lt;-<span class="st"> </span><span class="kw">gs_new</span>(<span class="st">&quot;foo&quot;</span>)
<span class="co">#&gt; Sheet &quot;foo&quot; created in Google Drive.</span>
<span class="co">#&gt; Worksheet dimensions: 1000 x 26.</span>
foo
<span class="co">#&gt;                   Spreadsheet title: foo</span>
<span class="co">#&gt;                  Spreadsheet author: gspreadr</span>
<span class="co">#&gt;   Date of googlesheets registration: 2015-10-10 21:58:19 GMT</span>
<span class="co">#&gt;     Date of last spreadsheet update: 2015-10-10 21:58:17 GMT</span>
<span class="co">#&gt;                          visibility: private</span>
<span class="co">#&gt;                         permissions: rw</span>
<span class="co">#&gt;                             version: new</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Contains 1 worksheets:</span>
<span class="co">#&gt; (Title): (Nominal worksheet extent as rows x columns)</span>
<span class="co">#&gt; Sheet1: 1000 x 26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Key: 18oPN8P35-UcvwhmGg4Z9l-3eZqUIMYsOOHFEWQ1sBKc</span>
<span class="co">#&gt; Browser URL: https://docs.google.com/spreadsheets/d/18oPN8P35-UcvwhmGg4Z9l-3eZqUIMYsOOHFEWQ1sBKc/</span></code></pre></div>
<p>By default, there will be an empty worksheet called “Sheet1”, but you can control it’s title, extent, and initial data with additional arguments to <code>gs_new()</code> (see <code>gs_edit_cells()</code> in the next section). You can also add, rename, and delete worksheets within an existing sheet via <code>gs_ws_new()</code>, <code>gs_ws_rename()</code>, and <code>gs_ws_delete()</code>. Copy an entire spreadsheet with <code>gs_copy()</code>.</p>
</div>
<div id="edit-cells" class="section level3">
<h3>Edit cells</h3>
<p>There are two ways to edit cells within an existing worksheet of an existing spreadsheet:</p>
<ul>
<li><code>gs_edit_cells()</code> can write into an arbitrary cell rectangle</li>
<li><code>gs_add_row()</code> can add a new row to the bottom of an existing cell rectangle</li>
</ul>
<p>If you have the choice, <code>gs_add_row()</code> is faster, but it can only be used when your data occupies a very neat rectangle in the upper left corner of the sheet. It relies on the <a href="https://developers.google.com/google-apps/spreadsheets/#working_with_list-based_feeds">list feed</a>. <code>gs_edit_cells()</code> relies on <a href="https://developers.google.com/google-apps/spreadsheets/#updating_multiple_cells_with_a_batch_request">batch editing</a> on the <a href="https://developers.google.com/google-apps/spreadsheets/#working_with_cell-based_feeds">cell feed</a>.</p>
<p>We’ll work within the completely empty sheet created above, <code>foo</code>. If your edit populates the sheet with everything it should have, set <code>trim = TRUE</code> and we will resize the sheet to match the data. Then the nominal worksheet extent is much more informative (vs. the default of 1000 rows and 26 columns) and future consumption via the cell feed will potentially be faster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## foo &lt;- gs_new(&quot;foo&quot;)
## initialize the worksheets
foo &lt;-<span class="st"> </span>foo %&gt;%<span class="st"> </span><span class="kw">gs_ws_new</span>(<span class="st">&quot;edit_cells&quot;</span>)
<span class="co">#&gt; Worksheet &quot;edit_cells&quot; added to sheet &quot;foo&quot;.</span>
<span class="co">#&gt; Worksheet dimensions: 1000 x 26.</span>
foo &lt;-<span class="st"> </span>foo %&gt;%<span class="st"> </span><span class="kw">gs_ws_new</span>(<span class="st">&quot;add_row&quot;</span>)
<span class="co">#&gt; Worksheet &quot;add_row&quot; added to sheet &quot;foo&quot;.</span>
<span class="co">#&gt; Worksheet dimensions: 1000 x 26.</span>

## add first six rows of iris data (and var names) into a blank sheet
foo &lt;-<span class="st"> </span>foo %&gt;%
<span class="st">  </span><span class="kw">gs_edit_cells</span>(<span class="dt">ws =</span> <span class="st">&quot;edit_cells&quot;</span>, <span class="dt">input =</span> <span class="kw">head</span>(iris), <span class="dt">trim =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Range affected by the update: &quot;A1:E7&quot;</span>
<span class="co">#&gt; Worksheet &quot;edit_cells&quot; successfully updated with 35 new value(s).</span>
<span class="co">#&gt; Accessing worksheet titled &quot;edit_cells&quot;</span>
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;foo&quot;</span>
<span class="co">#&gt; Accessing worksheet titled &quot;edit_cells&quot;</span>
<span class="co">#&gt; Worksheet &quot;edit_cells&quot; dimensions changed to 7 x 5.</span>

## initialize sheet with column headers and one row of data
## the list feed is picky about this
foo &lt;-<span class="st"> </span>foo %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gs_edit_cells</span>(<span class="dt">ws =</span> <span class="st">&quot;add_row&quot;</span>, <span class="dt">input =</span> <span class="kw">head</span>(iris, <span class="dv">1</span>), <span class="dt">trim =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Range affected by the update: &quot;A1:E2&quot;</span>
<span class="co">#&gt; Worksheet &quot;add_row&quot; successfully updated with 10 new value(s).</span>
<span class="co">#&gt; Accessing worksheet titled &quot;add_row&quot;</span>
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;foo&quot;</span>
<span class="co">#&gt; Accessing worksheet titled &quot;add_row&quot;</span>
<span class="co">#&gt; Worksheet &quot;add_row&quot; dimensions changed to 2 x 5.</span>
## add the next 5 rows of data ... careful not to go too fast
for(i in <span class="dv">2</span>:<span class="dv">6</span>) {
  foo &lt;-<span class="st"> </span>foo %&gt;%<span class="st"> </span><span class="kw">gs_add_row</span>(<span class="dt">ws =</span> <span class="st">&quot;add_row&quot;</span>, <span class="dt">input =</span> iris[i, ])
  <span class="kw">Sys.sleep</span>(<span class="fl">0.3</span>)
}
<span class="co">#&gt; Row successfully appended.</span>
<span class="co">#&gt; Row successfully appended.</span>
<span class="co">#&gt; Row successfully appended.</span>
<span class="co">#&gt; Row successfully appended.</span>
<span class="co">#&gt; Row successfully appended.</span>

## let's inspect out work
foo %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;edit_cells&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;edit_cells&quot;</span>
<span class="co">#&gt; Source: local data frame [6 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt;          (dbl)       (dbl)        (dbl)       (dbl)   (chr)</span>
<span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span>
foo %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;add_row&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;add_row&quot;</span>
<span class="co">#&gt; Source: local data frame [6 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt;          (dbl)       (dbl)        (dbl)       (dbl)   (chr)</span>
<span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></code></pre></div>
<p>Go to <a href="https://docs.google.com/spreadsheets/u/0/">your Google Sheets home screen</a>, find the new sheet <code>foo</code> and look at it. You should see some iris data in the worksheets named <code>edit_cells</code> and <code>add_row</code>.</p>
<p>Note how we always store the returned value from <code>gs_edit_cells()</code> (and all other sheet editing functions). That’s because the registration info changes whenever we edit the sheet and we re-register it inside these functions, so this idiom will help you make sequential edits and queries to the same sheet.</p>
<p>Read the function documentation for <code>gs_edit_cells()</code> for how to specify where the data goes, via an anchor cell, and in which direction, via the shape of the input or the <code>byrow =</code> argument.</p>
</div>
<div id="delete-sheets" class="section level3">
<h3>Delete sheets</h3>
<p>Let’s clean up by deleting the <code>foo</code> spreadsheet we’ve been playing with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gs_delete</span>(foo)
<span class="co">#&gt; Success. &quot;foo&quot; moved to trash in Google Drive.</span></code></pre></div>
<p>If you’d rather specify sheets for deletion by title, look at <code>gs_grepdel()</code> and <code>gs_vecdel()</code>. These functions also allow the deletion of multiple sheets at once.</p>
</div>
<div id="upload-delimited-files-or-excel-workbooks" class="section level3">
<h3>Upload delimited files or Excel workbooks</h3>
<p>Here’s how we can create a new spreadsheet from a suitable local file. First, we’ll write then upload a comma-delimited excerpt from the iris data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris %&gt;%
<span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) %&gt;%
<span class="st">  </span><span class="kw">write.csv</span>(<span class="st">&quot;iris.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
iris_ss &lt;-<span class="st"> </span><span class="kw">gs_upload</span>(<span class="st">&quot;iris.csv&quot;</span>)
<span class="co">#&gt; &quot;iris.csv&quot; uploaded to Google Drive and converted to a Google Sheet named &quot;iris&quot;</span>
iris_ss
<span class="co">#&gt;                   Spreadsheet title: iris</span>
<span class="co">#&gt;                  Spreadsheet author: gspreadr</span>
<span class="co">#&gt;   Date of googlesheets registration: 2015-10-10 21:59:01 GMT</span>
<span class="co">#&gt;     Date of last spreadsheet update: 2015-10-10 21:58:58 GMT</span>
<span class="co">#&gt;                          visibility: private</span>
<span class="co">#&gt;                         permissions: rw</span>
<span class="co">#&gt;                             version: new</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Contains 1 worksheets:</span>
<span class="co">#&gt; (Title): (Nominal worksheet extent as rows x columns)</span>
<span class="co">#&gt; iris: 1000 x 26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Key: 1CILlVP4g24-3_6cV7S-7honwEEmUKBAK0Qflf1IlbKM</span>
<span class="co">#&gt; Browser URL: https://docs.google.com/spreadsheets/d/1CILlVP4g24-3_6cV7S-7honwEEmUKBAK0Qflf1IlbKM/</span>
iris_ss %&gt;%<span class="st"> </span><span class="kw">gs_read</span>()
<span class="co">#&gt; Accessing worksheet titled &quot;iris&quot;</span>
<span class="co">#&gt; Source: local data frame [5 x 5]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt;          (dbl)       (dbl)        (dbl)       (dbl)   (chr)</span>
<span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="kw">file.remove</span>(<span class="st">&quot;iris.csv&quot;</span>)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Now we’ll upload a multi-sheet Excel workbook. Slowly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_xlsx &lt;-<span class="st"> </span><span class="kw">gs_upload</span>(<span class="kw">system.file</span>(<span class="st">&quot;mini-gap.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;googlesheets&quot;</span>))
<span class="co">#&gt; &quot;mini-gap.xlsx&quot; uploaded to Google Drive and converted to a Google Sheet named &quot;mini-gap&quot;</span>
gap_xlsx
<span class="co">#&gt;                   Spreadsheet title: mini-gap</span>
<span class="co">#&gt;                  Spreadsheet author: gspreadr</span>
<span class="co">#&gt;   Date of googlesheets registration: 2015-10-10 21:59:08 GMT</span>
<span class="co">#&gt;     Date of last spreadsheet update: 2015-10-10 21:59:05 GMT</span>
<span class="co">#&gt;                          visibility: private</span>
<span class="co">#&gt;                         permissions: rw</span>
<span class="co">#&gt;                             version: new</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Contains 5 worksheets:</span>
<span class="co">#&gt; (Title): (Nominal worksheet extent as rows x columns)</span>
<span class="co">#&gt; Africa: 1000 x 26</span>
<span class="co">#&gt; Americas: 1000 x 26</span>
<span class="co">#&gt; Asia: 1000 x 26</span>
<span class="co">#&gt; Europe: 1000 x 26</span>
<span class="co">#&gt; Oceania: 1000 x 26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Key: 1cCOXyK0zslTnl6PBssvAwPIubpTlVmCsdjuglHUbxys</span>
<span class="co">#&gt; Browser URL: https://docs.google.com/spreadsheets/d/1cCOXyK0zslTnl6PBssvAwPIubpTlVmCsdjuglHUbxys/</span>
gap_xlsx %&gt;%<span class="st"> </span><span class="kw">gs_read</span>(<span class="dt">ws =</span> <span class="st">&quot;Asia&quot;</span>)
<span class="co">#&gt; Accessing worksheet titled &quot;Asia&quot;</span>
<span class="co">#&gt; Source: local data frame [5 x 6]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       country continent  year lifeExp       pop gdpPercap</span>
<span class="co">#&gt;         (chr)     (chr) (int)   (dbl)     (int)     (dbl)</span>
<span class="co">#&gt; 1 Afghanistan      Asia  1952  28.801   8425333  779.4453</span>
<span class="co">#&gt; 2     Bahrain      Asia  1952  50.939    120447 9867.0848</span>
<span class="co">#&gt; 3  Bangladesh      Asia  1952  37.484  46886859  684.2442</span>
<span class="co">#&gt; 4    Cambodia      Asia  1952  39.417   4693836  368.4693</span>
<span class="co">#&gt; 5       China      Asia  1952  44.000 556263527  400.4486</span></code></pre></div>
<p>And we clean up after ourselves on Google Drive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gs_vecdel</span>(<span class="kw">c</span>(<span class="st">&quot;iris&quot;</span>, <span class="st">&quot;mini-gap&quot;</span>))
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;mini-gap&quot;</span>
<span class="co">#&gt; Success. &quot;mini-gap&quot; moved to trash in Google Drive.</span>
<span class="co">#&gt; Authorization will be used.</span>
<span class="co">#&gt; Sheet successfully identifed: &quot;iris&quot;</span>
<span class="co">#&gt; Success. &quot;iris&quot; moved to trash in Google Drive.</span>
<span class="co">#&gt; [1] TRUE TRUE</span>
## achieves same as:
## gs_delete(iris_ss)
## gs_delete(gap_xlsx)</code></pre></div>
</div>
<div id="download-sheets-as-csv-pdf-or-xlsx-file" class="section level3">
<h3>Download sheets as csv, pdf, or xlsx file</h3>
<p>You can download a Google Sheet as a csv, pdf, or xlsx file. Downloading the spreadsheet as a csv file will export the first worksheet (default) unless another worksheet is specified.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gs_title</span>(<span class="st">&quot;Gapminder&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">gs_download</span>(<span class="dt">ws =</span> <span class="st">&quot;Africa&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;gapminder-africa.csv&quot;</span>)
<span class="co">#&gt; Sheet successfully identifed: &quot;Gapminder&quot;</span>
<span class="co">#&gt; Accessing worksheet titled &quot;Africa&quot;</span>
<span class="co">#&gt; Sheet successfully downloaded: /Users/jenny/rrr/googlesheets/vignettes/gapminder-africa.csv</span>
## is it there? yes!
<span class="kw">read.csv</span>(<span class="st">&quot;gapminder-africa.csv&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">head</span>()
<span class="co">#&gt;   country continent year lifeExp      pop gdpPercap</span>
<span class="co">#&gt; 1 Algeria    Africa 1952  43.077  9279525  2449.008</span>
<span class="co">#&gt; 2 Algeria    Africa 1957  45.685 10270856  3013.976</span>
<span class="co">#&gt; 3 Algeria    Africa 1962  48.303 11000948  2550.817</span>
<span class="co">#&gt; 4 Algeria    Africa 1967  51.407 12760499  3246.992</span>
<span class="co">#&gt; 5 Algeria    Africa 1972  54.518 14760787  4182.664</span>
<span class="co">#&gt; 6 Algeria    Africa 1977  58.014 17152804  4910.417</span></code></pre></div>
<p>Download the entire spreadsheet as an Excel workbook.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gs_title</span>(<span class="st">&quot;Gapminder&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gs_download</span>(<span class="dt">to =</span> <span class="st">&quot;gapminder.xlsx&quot;</span>)
<span class="co">#&gt; Sheet successfully identifed: &quot;Gapminder&quot;</span>
<span class="co">#&gt; Sheet successfully downloaded: /Users/jenny/rrr/googlesheets/vignettes/gapminder.xlsx</span></code></pre></div>
<p>Go check it out in Excel, if you wish!</p>
<p>And now we clean up the downloaded files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">file.remove</span>(<span class="kw">c</span>(<span class="st">&quot;gapminder.xlsx&quot;</span>, <span class="st">&quot;gapminder-africa.csv&quot;</span>))
<span class="co">#&gt; [1] TRUE TRUE</span></code></pre></div>
</div>
<div id="authorization-using-oauth2" class="section level3">
<h3>Authorization using OAuth2</h3>
<p>If you use a function that requires authorization, it will be auto-triggered. But you can also initiate the process explicitly if you wish, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Give googlesheets permission to access your spreadsheets and google drive</span>
<span class="kw">gs_auth</span>() </code></pre></div>
<p>Use <code>gs_auth(new_user = TRUE)</code>, to force the process to begin anew. Otherwise, the credentials left behind will be used to refresh your access token as needed.</p>
<p>The function <code>gs_user()</code> will print and return some information about the current authenticated user and session.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">user_session_info &lt;-<span class="st"> </span><span class="kw">gs_user</span>()
<span class="co">#&gt;           displayName: google sheets</span>
<span class="co">#&gt;          emailAddress: gspreadr@gmail.com</span>
<span class="co">#&gt;                  date: 2015-10-10 21:57:55 GMT</span>
<span class="co">#&gt;          access token: valid</span>
<span class="co">#&gt;  peek at access token: ya29....s6sV0</span>
<span class="co">#&gt; peek at refresh token: 1/zNh...ATCKT</span>
user_session_info
<span class="co">#&gt; $displayName</span>
<span class="co">#&gt; [1] &quot;google sheets&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $emailAddress</span>
<span class="co">#&gt; [1] &quot;gspreadr@gmail.com&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $date</span>
<span class="co">#&gt; [1] &quot;2015-10-10 21:57:55 GMT&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $token_valid</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $peek_acc</span>
<span class="co">#&gt; [1] &quot;ya29....s6sV0&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $peek_ref</span>
<span class="co">#&gt; [1] &quot;1/zNh...ATCKT&quot;</span></code></pre></div>
</div>
<div id="old-google-sheets" class="section level3">
<h3>“Old” Google Sheets</h3>
<p>In March 2014 <a href="https://support.google.com/docs/answer/3541068?hl=en">Google introduced “new” Sheets</a>. “New” Sheets and “old” sheets behave quite differently with respect to access via API and present a big headache for us. Recently, we’ve noted that Google is forcibly converting sheets: <a href="https://support.google.com/docs/answer/6082736?p=new_sheets_migrate&amp;rd=1">all “old” Sheets will be switched over the “new” sheets during 2015</a>. However there are still “old” sheets lying around, so we’ve made some effort to support them, when it’s easy to do so. But keep your expectations low.</p>
<p>In particular, <code>gs_read_csv()</code> does not currently work for “old” sheets.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
