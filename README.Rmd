---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

[![Project Status: Wip - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](http://www.repostatus.org/badges/0.1.0/wip.svg)](http://www.repostatus.org/#wip)

**If the feature's here, then it works. More features and release coming soon.**

---

Google Sheets R API
---
[![Build Status](https://travis-ci.org/jennybc/gspreadr.png?branch=master)](https://travis-ci.org/jennybc/gspreadr)

Manage your spreadsheets with *gspreadr* in R. 

*gspreadr* is inspired by [gspread](https://github.com/burnash/gspread), a Google Spreadsheets Python API

Features:

  - Access a spreadsheet by its title, key or URL.
  - Extract data or edit data.
  - Add | delete | rename | copy spreadsheets and worksheets.

Basic Usage
---
```{r load-package}
library("gspreadr")
suppressMessages(library("dplyr"))
```

```{r basic-usage}
# See what spreadsheets you have
# (expect a prompt to authenticate with Google interactively HERE)
(my_sheets <- list_sheets())
my_sheets %>% glimpse()

# Hey let's look at the Gapminder data
gap <- register_ss("Gapminder")
str(gap)

# Need to access a sheet you do not own?
## Access it by key if you know it!
gap_key <- "1hS762lIJd2TRUTVOqoOP7g-h4MDQs6b2vhkTzohg8bE"
gap <- gap_key %>% register_ss

# gspreadr may be able to determine the key from the browser URL
gap_url <- "https://docs.google.com/spreadsheets/d/1hS762lIJd2TRUTVOqoOP7g-h4MDQs6b2vhkTzohg8bE/"
gap <- gap_url %>% register_ss

# Get the data for worksheet "Oceania": the fast tabular way ("list feed")
oceania_list_feed <- gap %>% get_via_lf(ws = "Oceania") 
str(oceania_list_feed, give.attr = FALSE)
oceania_list_feed

# Get the data for worksheet "Oceania": the slower cell-by-cell way ("cell feed")
oceania_cell_feed <- gap %>% get_via_cf(ws = "Oceania") 
str(oceania_cell_feed, give.attr = FALSE)
head(oceania_cell_feed, 10)

# Reshape: instead of one row per cell, make a nice rectangular data.frame
oceania_reshaped <- oceania_cell_feed %>% reshape_cf()
str(oceania_reshaped, give.attr = FALSE)
head(oceania_reshaped, 10)

# Limit data retrieval to certain cells

# Example: first 3 rows
gap_3rows <- gap %>% get_row("Europe", row = 1:3)
gap_3rows %>% head()

# convert to a data.frame (first row treated as header by default)
gap_3rows %>% reshape_cf()

# Example: first row only
gap_1row <- gap %>% get_row("Europe", row = 1)
gap_1row

# convert to a named character vector
gap_1row %>% simplify_cf()

# just 2 columns, converted to data.frame
gap %>%
  get_col("Oceania", col = 3:4) %>%
  reshape_cf()

# arbitrary cell range
gap %>%
  get_cells("Oceania", range = "D12:F15") %>%
  reshape_cf(header = FALSE)

# arbitrary cell range, alternative specification
gap %>%
  get_via_cf("Oceania", max_row = 5, min_col = 1, max_col = 3) %>%
  reshape_cf()
```

Authorization using OAuth2 (recommended and auto-triggered in many cases)
---

```{r authorize, eval = FALSE}
# Give gspreadr permission to access your spreadsheets and google drive
authorize() 
```

Stuff we are in the process of bringing back online after the Great Refactor of February 2015
---

  * edit cells (see #42)
  * visual overview of which cells are populated
