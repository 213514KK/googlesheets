---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

[![Project Status: Wip - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](http://www.repostatus.org/badges/0.1.0/wip.svg)](http://www.repostatus.org/#wip)

**Not quite ready for showtime but release coming very soon!**

---

Google Sheets R API
---
[![Build Status](https://travis-ci.org/jennybc/gspreadr.png?branch=master)](https://travis-ci.org/jennybc/gspreadr)

Manage your spreadsheets with *gspreadr* in R. 

*gspreadr* is inspired by [gspread](https://github.com/burnash/gspread), a Google Spreadsheets Python API

Features:

  - Access a spreadsheet by its title, key or URL.
  - Extract data or edit data.
  - Add | delete | rename | copy spreadsheets and worksheets.

![gspreadr](README-gspreadr.png)

Basic Usage
---
```{r load-package}
library("gspreadr")
suppressMessages(library("dplyr"))
```

```{r basic-usage}
# See what spreadsheets you have
# (expect a prompt to authenticate with Google interactively HERE)
(my_sheets <- list_sheets())
my_sheets %>% glimpse()

# Hey let's look at the Gapminder data
gap <- register_ss("Gapminder")
str(gap)

# Need to access a sheet you do not own?
## Access it by key if you know it!
gap_key <- "1hS762lIJd2TRUTVOqoOP7g-h4MDQs6b2vhkTzohg8bE"
gap <- gap_key %>% register_ss

# gspreadr may be able to determine the key the browser URL
gap_url <- "https://docs.google.com/spreadsheets/d/1hS762lIJd2TRUTVOqoOP7g-h4MDQs6b2vhkTzohg8bE/"
gap <- gap_url %>% register_ss

# Get the data for worksheet "Oceania": the fast tabular way ("list feed")
oceania_list_feed <- gap %>% get_via_lf(ws = "Oceania") 
str(oceania_list_feed, give.attr = FALSE)
oceania_list_feed

# Get the data for worksheet "Oceania": the slower cell-by-cell way ("cell feed")
oceania_cell_feed <- gap %>% get_via_cf(ws = "Oceania") 
str(oceania_cell_feed, give.attr = FALSE)
head(oceania_cell_feed, 10)
oceania_reshaped <- oceania_cell_feed %>% reshape_cf()
str(oceania_reshaped, give.attr = FALSE)
head(oceania_reshaped, 10)
```

Authorization
---
##### Authorization using OAuth2 (recommended and auto-triggered in many cases)
```{r authorize, eval = FALSE}
# Give gspreadr permission to access your spreadsheets and google drive
authorize() 
```

##### Alternate authorization: login with your Google account

```{r login, eval = FALSE}
login("my_email", "password")
```
  
Stuff we are in the process of bringing back online after the Great Refactor of February 2015
---

  * convenience wrappers for the cell feed, i.e. row(s), column(s), range
  * edit cells
  * visual overview of which cells are populated
  * finding a cell ?will we even do this?
  